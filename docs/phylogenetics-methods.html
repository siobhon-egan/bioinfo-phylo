<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Methods</title>

<script src="site_libs/jquery-3.5.0/jquery-3.5.0.min.js"></script>
<meta name="name" content="viewport" />
<meta name="content" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="site_libs/bootstrap-3.4.1/bootstrap-custom.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.4.1/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre {
    background-color: #f5f5f5;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: .5rem;
  }
  pre:not([class]) {
    background-color: white;
  }
  pre code {
    background-color: transparent;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}

.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* TODO: remove this padding CSS when we drop BS3 */
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}

.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!--
  Note that .tabset-dropdown was initially implemented using Glyphicons, which were dropped
  in BS4. The idea behind the "equivalent" BS4 CSS derives from how carets are implemented
  https://github.com/twbs/bootstrap/blob/099860/scss/mixins/_caret.scss#L1
-->
<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active-dropdown-tab:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active-dropdown-tab:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active-dropdown-tab {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Research</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-paper-plane"></span>
     
    Research tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="research.html">Introduction</a>
    </li>
    <li>
      <a href="writing.html">Writing</a>
    </li>
    <li>
      <a href="referencing.html">Referencing</a>
    </li>
    <li>
      <a href="journals.html">Journals</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-terminal"></span>
     
    Code &amp; data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="code.html">Introduction</a>
    </li>
    <li>
      <a href="unix.html">Unix</a>
    </li>
    <li>
      <a href="github.html">GitHub</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-alt"></span>
     
    RStudio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="rstudio-intro.html">Introduction</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Plots &amp; data</li>
    <li>
      <a href="rstudio-aesthetics.html">Aesthetics</a>
    </li>
    <li>
      <a href="rstudio-plots.html">Plots</a>
    </li>
    <li>
      <a href="rstudio-statistics.html">Statistics</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">RMarkdown</li>
    <li>
      <a href="rmd-intro.html">Introduction</a>
    </li>
    <li>
      <a href="rmd-bookdown.html">Bookdown</a>
    </li>
    <li>
      <a href="rmd-webpages.html">Websites</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-dna"></span>
     
    Sequence files
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="sequence-files.html">Command line</a>
    </li>
    <li>
      <a href="visualise.html">Visualising and editing</a>
    </li>
    <li>
      <a href="muscle.html">Muscle</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-code-branch"></span>
     
    Phylogenetics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="phylo-intro.html">Introduction</a>
    </li>
    <li>
      <a href="phylogenetics-methods.html">Methods</a>
    </li>
    <li>
      <a href="evolutionary-models.html">Evolutionary models</a>
    </li>
    <li>
      <a href="iqtree.html">IQ-TREE</a>
    </li>
    <li>
      <a href="mrbayes.html">MrBayes</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/siobhon-egan">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Methods</h1>

</div>


<p>There are four popular molecular phylogenetic methods.</p>
<p><i class="fas fa-link"></i> The following is a summary of information from a number of resources, workshops and other bits I have come across during my data analysis learning. As with the rest of this webpage it is certainly not extensive and written in a context relevent to the work I do (i.e. parasite identification and a dabble in taxonomy and systematics).</p>
<ul>
<li>Australian National Postgraduate Training Workshop in Systematics support by the <a href="https://www.sasb.org.au">Society of Australian Systematic Biologists</a>, <a href="http://www.environment.gov.au/science/abrs">The Australian Biological Resources Study</a> and <a href="https://www.adelaide.edu.au/environment/acebb/">Australian Centre for Evolutionary Biology and Biodiversity</a></li>
<li><a href="https://github.com/simon-ho/SydneyPhyloWorkshop">Sydney Phylo Workshop</a> by Simon Ho.</li>
</ul>
<div id="maximum-parsimony" class="section level2">
<h2>1. Maximum parsimony</h2>
<p>Identifies the tree topology that can explain the sequence data, using the smallest number of inferred substitution events. It is commonly used for morphological data, and now days is rarely used for analysing genetic data. It cannot estimate evolutionary rates or timescales and does not correct for multiple substitutions at the same site which leads to what is known as “long-branch attraction”.</p>
</div>
<div id="distance-based-methods" class="section level2">
<h2>2. Distance-based methods</h2>
<p>Clustering algorithms - Unweighted Pair Group Method with Arithmetic Mean (UPGMA) - Neighbour joining (NJ)</p>
<p>Tree searching using optimality criteria - Minimum evolution - Least-squares inference</p>
<p><em>Pros</em></p>
<ul>
<li>Able to take into account multiple substitutions and long-branch attraction</li>
<li>Useful for analysing very large data sets with a lot of taxa (1000’s +)</li>
</ul>
<p><em>Cons</em></p>
<ul>
<li>Does not use all information in alignment</li>
<li>Loss of information in pairwise comparisons</li>
<li>Unable to implement sophisticated evolutionary models</li>
</ul>
</div>
<div id="maximum-likelihood-ml" class="section level2">
<h2>3. Maximum likelihood (ML)</h2>
<ul>
<li>Search through the space of possible trees and parameter values</li>
<li>Calculate the likelihood for these</li>
<li>Find best tree and model parameter values</li>
<li>Multivariate optimisation</li>
</ul>
<p><em>Pros</em></p>
<ul>
<li>Rigorous statistical method</li>
<li>Deals with multiple substitutions and long-branch attraction</li>
<li>Highly robust to violations of assumptions</li>
</ul>
<p><em>Cons</em></p>
<ul>
<li>Not feasible to implement very parameter-rich models</li>
<li>Searching tree space can be difficult</li>
</ul>
<p><em>ML Analysis</em></p>
<ul>
<li>RAxML = Randomized Axelerated Maximum Likelihood. Rapid bootstrapping and can run sequentially or in parallel.</li>
<li>PhyML</li>
<li>MEGA</li>
<li>PAML</li>
<li>IQ-Tree</li>
</ul>
</div>
<div id="bayesian-inference" class="section level2">
<h2>4. Bayesian inference</h2>
<p>Bayesian phylogenetic analysis was developed in the mid 1990s, and it now one of the most widely used methods for molecular phylogenetics.</p>
<p>Key features of Bayesian paradigm</p>
<ul>
<li>Contrast with frequentist statistics (likelihood)</li>
<li>Parameters have distributions</li>
<li>Before the data are observed, each parameter has a prior distribution</li>
<li>The likelihood of the data is computed</li>
<li>The prior distribution is combined (updated) with the likelihood to yield the posterior distribution</li>
</ul>
<p><em>Priors</em></p>
<ul>
<li>Priors are chosen in the form of probability distributions</li>
<li>Reflect our prior expectations (and uncertainty) about values of parameters (without knowledge of the data)
<ul>
<li>Past observations</li>
<li>Personal beliefs</li>
<li>Use of a biological model</li>
</ul></li>
<li>Uninformative priors</li>
</ul>
<p><em>‘Prior options’</em></p>
<ol style="list-style-type: decimal">
<li>Use a flat prior for tree topology (MrBayes)
<ul>
<li>All trees have equal probability</li>
<li>Also need a prior for branch lengths or node times</li>
</ul></li>
<li>Use a biological model to generate prior distribution (BEAST and MrBayes)
<ul>
<li>Among species: speciation model</li>
<li>Within species: coalescent model</li>
</ul></li>
</ol>
<p><em>Markov Chain Monte Carlo Sampling</em></p>
<p>It is impossible to obtain the posterior directly. Instead, the posterior can be estimated using Markov chain Monte Carlo simulation. This is usually done using the Metropolis-Hastings algorithm. There is a wealth of literature available for more information on this topic. It can get super technical - we’ve just covered the basics.</p>
<p><em>Pros</em></p>
<ul>
<li>Able to implement highly parameterised models</li>
<li>Estimating tree uncertainty is straightforward</li>
<li>Can only do this indirectly in likelihood (via bootstrapping)</li>
<li>Posterior probabilities have an intuitive interpretation</li>
<li>Can incorporate independent information (in the prior)</li>
</ul>
<p><em>Popular software and programs for Bayesian analysis</em></p>
<ul>
<li>MrBayes
<ul>
<li>Primarily designed for species-level data</li>
<li>Simultaneous estimation of tree and node times</li>
<li>Range of clock models</li>
<li>Range of tree priors</li>
<li>Multiple chains and MCMC diagnostics</li>
</ul></li>
<li>RevBayes
<ul>
<li>Uses its own R-like language, Rev</li>
<li>Interactive construction of graphical model</li>
<li>Flexible and can be used for simulation and inference</li>
<li>Ongoing development</li>
</ul></li>
<li>BEAST1 = Bayesian Evolutionary Analysis by Sampling Trees
<ul>
<li>Analyse population- or species-level data</li>
<li>Simultaneous estimation of tree and node times</li>
<li>Range of clock models</li>
<li>Range of tree priors and demographic models</li>
</ul></li>
<li>BEAST2
<ul>
<li>Re-write of BEAST to increase modularity</li>
<li>Users can extend BEAST by adding packages</li>
<li>Additional tree priors not available in BEAST 1</li>
<li>Capacity to perform simulations</li>
<li>For a comparison of BEAST 1 and 2: www.beast2.org/beast-features</li>
</ul></li>
</ul>
</div>
<div id="bootstrapping" class="section level2">
<h2>Bootstrapping</h2>
<p>Felsenstein (1985) Evolution 39(4):783-791 (<a href="https://www.ncbi.nlm.nih.gov/pubmed/28561359">Pub med</a>) Bootstrapping provides a confidence interval that contains the phylogeny that would be estimated from repeated sampling of many characters from the underlying set of all characters. Bootstrap values are measures of repeatability. High when the data set is large. Not meaningful when analysing genome-scale data.</p>
</div>

<p>Copyright &copy; Siobhon L. Egan.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
    $(this).siblings().removeClass("active-dropdown-tab");
    $(this).addClass("active-dropdown-tab");
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
